# 2. 확장성과 안정성 높은 서버 만들기

---

### 1. 서버와 스토리지

- 특화된 어떤 업무를 수행하기 위해 설계된 컴퓨터 => `서버`
- 정보와 데이터를 저장하기 위한 저장소 역할을 수행하는 것 => `스토리지`

<br />

#### 서버

- 특화된 임무를 수행하기 위해 일반 컴퓨터보다  고성능의 CPU, 빠르고 고용량의 메모리, 대용량의 디스크가 요구됨. => 즉, 일반 PC보다는 높은 사양의 하드웨어를 요구
- 서비스의 용도에 따라 다양한 서버용 OS(UNIX, Linux, Windows)를 사용
- 서버의 용도에 맞는 특화된 임무를 수행하기 위한 별도의 SW들이 설치됨
- AWS는 EC2(Elastic Compute Cloud)라는 서비스를 이용해 가상의서버를 구성하고 필요한 SW를 설치하여 사용

#### 하드디스크
- 하드디스크는 스핀들 모터 방식의 기계식 `하드 디스크`와 플래시 메모리 기반의 전자식으로 동작하는 `SSD(Solid-State Drive) 디스크` 가 있다.
- SSD 디스크는 기계식 디스크보다 향상된 검색 속도, 낮은 지연속도, 낮은 소음을 가지지만 기계식보다 용량대비 비용이 비싼것이 단점이다.
- 서버와 같이 고성능으로 대량의 데이터를 빠르게 처리하기 위해 `디스크 어레이 컨트롤러(Disk Array Controller)`와 `RAID(Redundant Array of Independent Disks)`와 같은 기술을 활용하여, 디스크 장애 발생시에도 데이터를 보호하며 보다 높은 성능을 제공할 수 있도록 구성한다. 
- AWS는 EBS(Elastic Block Storage) 서비스를 이용하여 EC2에 디스크를 추가하여 서비스를 사용할 수 있다. 

<br />

### 2. 보안과 방화벽

- 정보화 사회에서서버 및 스토리지 등 IT인프라에 저장된 중요한 정보를 보호하고 지키는 일은 무엇보다 중요하다. => `보안과 방화벽`이 이러한 중요한 역할을 한다


<br />

#### 보안(Security)

- AWS에서의 `보안`이라함은 클라우드 서비스를 안전하게 사용하기 위해 필요한 서비스를 말한다.
- AWS는 리소스에 대한 사용자 액세스 및 암호화 키 관리 서비스인 AWS IAM(Identity & Access Management), 관리형 위험 탐지 서비스 Amazon GuardDuty, DDoS 보호를 위한 AWS Shield, 악성 웹 트래픽 필터링을 위한 서비스인 AWS WAF(Web Application Firewall)등 다양한 보안 서비스를 제공한다.

#### 방화벽(Firewall)

- 정보 시스템에성의 방화벽은 인터넷과 같이 외부 네트워크에 연결되어 있는 내부 네트워크의 중요한 정보 자산에 대해 외부로부터 불접적인 침입을 보호하기 위한 시스템을 말한다.

- 외부 사용자 또는 외부 시스템이 내부의 서버 및 자원에 접근하기 위해서는 반드시 방화벽을 거쳐야 한다.
- 외부에서 내부로 공격이나 침입을 시도하더라도 방화벽을 거쳐야 하기 때문에 관리자가 이를 탐지하고 방어할 수 있는 시간을 벌 수 있으며, 근본적인 공격자체를 어렵게 만들 수 있다.
- AWS는 자체 방화벽인 Security Group, NACL, AWS WAF(Web Application Firewall)을 통해 방화벽 서비스를 제공한다.

<br />

### 3. 클라우드 용어

- Amazon Web Service 는 전세계를 대상으로 클라우드 서비스를 제공하기 위해 전세계 주요 지역에 IDC(Internet Data Center)를 구축하여 운영한다.
- 이러한 클라우드 서비스를 위한 인프라 환경을 크게 리전(Region), 가용 영역(Availability Zone), 엣지 로케이션(Edge Location)으로 구분할 수 있다.

<br />

#### 리전(Region)

- 아마존은 전세계 주요 국가에 리전(Region)을 구축하여 해당 위치에서 가장 가까운 곳에서 클라우드 서비스를 이용할 수 있도록 서비스를 제공한다. => 우리나라에서는 2016년 1월 부터 서울 리전이 오픈되었다.

<br />

#### 가용영역(Availability Zone)

- 가용영역(Availability Zone, 이하 AZ)이란 우리가 흔히 알고 있는 데이터센터를 말한다.
- AWS 하나의 리전에 다수의 가용영역을 보유하고 있고, 가용영역이 위치한 데이터 센터는 같은 리전이어도 지리적으로 멀리 떨어져 있다. 
- 가용영역이 이렇게 물리적으로 떨어져 있는 이유는 하나의 가용영역이 재해, 정전, 테러 화재 등 다양한 이유로 작동 불능이 되더라도 다른 가용영역에서 서비스를 재개할 수 있도록 하기 위함이다.
- 한국은 서울 리전에 3개의 가용영역을 구축하여 운영하고 있다.

<br />

#### 엣지 로케이션(Edge Location)

- 엣지 로케이션이란 아마존의 CDN 서비스인 CloudFront를 위한 캐시 서버들의 모음을 의미한다.
- CDN서비스는 Content Delivery Network의 약자로 콘텐츠(HTML,이미지,동영상,기타파일등)를 서버와 물리적으로 사용자들이 빠르게 받을 수 있도록 전세계 곳곳에 위치한 캐시서버에 복제해주는 서비스이다.
- 콘텐츠를 빠르게 받기위해 물리적으로 멀리 떨어진 서버에서 다운로드하는 것보다, 가까운 서버에 접속하여 다운로드 받는 것이 속도가 훨씬 빠르기 때문에 CDN서비스는 전세계 주요 도시에 캐시 서버를 구축해 놓는다.
- AWS CloudFront 는 가장 빠르게 성장하고 있는 CDN 서비스로 2020년 기준 글로벌 205개의 엣지 로케이션을 보유하고 있다.

<br />

### 4. Amazon EC2(Elastic Compute Cloud)

<br />

#### Amazon EC2

- Amazon EC2 는 Elastic Compute Cloud의 약자로 Amazon Web Services 상에서 안정적이며, 크기를 조정 가능한 컴퓨팅 파워를 제공하는 웹서비스를 말한다.
- 이러한 가상화 서버를 인스턴스라고 부르며, 필요에 따라 한개의 인스턴스에서 수천개의 인스턴스로 손쉽게 컴퓨팅 파워를 확장할 수 있다.

|구분|내용|
|:---:|:---|
|서비스명|Amazon EC2|
|설명|클라우드에서 제공되는 크기를 조정할 수 있는 컴퓨팅 파워|
|주요 특징|- 한개에서 수천개의 인스턴스로 확장가능 <br /> - 모든 공개된 AWS Region에서 사용가능 <br /> - 필요에 따라 인스턴스의 생성, 시작, 수정, 중단, 삭제 가능 <br /> - Linux/Windows OS에서 사용 가능하며 모든 SW 설치 가능 <br /> - 사용한 사용량에 대해서만 시간단위 비용 과금 <br /> - 다양한 비용 모델(온디멘드, 스팟, 예약) 선택 가능|

<br />

#### Amazon EC2의 주요 특징

##### 1. 인스턴스 유형

- 유형은 크게 `범용(M 시리즈)`, `컴퓨팅 최적화(C 시리즈)`, `스토리지 최적화(I 시리즈, D 시리즈)`, `GPU 최적화(G 시리즈)`, `메모리 최적화(R 시리즈)` 로 나눌 수 있다.
- 또한 본인이 선택하는 인스턴스의 유형과 사이즈에 따라 최종으로 사용하게 될 인스턴스의 타입을 선택할 수 있고, CPU Core 수, 메모리 용량, 네트워크 인터페이스의 속도 등을 필요에 따라 선택할 수 있다.

##### 2. 인스턴스 구매 옵션 - p.30 참조

<br />

#### Amazon EBS(Elastic Block Storage)

- EC2에 연결되는 Block Level의 스토리지 서비스이다.
- 서버에 장착하는 서버용 하드디스크라고 생각하면 된다.

|구분|내용|
|:---:|:--|
|서비스명|Amazon EBS|
|설명|EC2 인스턴스용 영구 블록 수준의 스토리지 볼륨으로 안정적이고 지연 시간이 짧음|
|주요특징|- 크기는 1GB 단위로 1GB ~ 1TB까지 사용가능 <br /> - 크기/사용 기간을 기준으로 비용과금 <br /> - 마그네틱의 경우 발생하는 I/O 횟수에도 비용 과금 <br /> - EC2 인스턴스와 독립적으로 사용 가능하며, 다른 EC2 인스턴스에 교체 가능 <br /> - 데이터는 영구적으로 저장되며, 원하는 가용 영역에 생성 가능 <br /> - 백업된 스냅샷에서 EBS 볼륨을 생성/복원 가능|


<br />


#### Amazon EBS의 주요 특징

- Amazon EBS 볼륨 유형 
  - EBS는 서비스 타입에 따라 크게 5가지의 서비스로 분류할 수 있다.
    1. 범용 SSD
    2. 프로비저닝 된 IOPS
    3. 처리량 최적화 HDD
    4. 콜드 HDD
    5. 마그네틱 
    - 자세한 내용은 p.32 참조
  - 보통 범용 SSD를 사용한다. 저렴한 비용을 원한다면 마그네틱도 나쁘지 않음

<br />

##### Amazon EBS 스냅샷 활용 

- Amazon EBS의 스냅샷 기능은 Amazon EBS 볼륨의 데이터를 스냅샷으로 만들어 Amazon S3에 백업 및 보관할 수 있는 기능이다.
- 컴퓨터의 하드디스크를 통째로 백업할 수 있는 기능이라고 생각하면 된다.
- 이렇게 백업받은 스냅샷으로 다시 Amazon EBS 볼륨을 생성하거나, 다른 EC2로 연결하여 데이터를 복원하는 작업을 수행할 수 있다.

<br />

- Amazon EBS 스냅샷은 4가지 특징을 가진다.
  1. Amazon EBS 스냅샷은 스냅샷 진행 과정 중에도 Amazon EBS 나 EC2의 서비스 중단 없이 기존 서비스를 즉시 사용 가능하다.
  2. Amazon EBS 볼륨의 크기 조정에 사용될 수 있다. 보통 Disk의 크기를 늘리는 작업을 수행하는 경우 기존 disk 를 스냅샷으로 백업 후 신규로 장착할 Amazon EBS의 크기를 늘려서 볼륨의 사이즈를 늘릴 수 있다.
  3. 스냅샷의 공유 기능을 활용하여 권한이 있는 다른 사용자에게 공유할 수 있으며, 이렇게 공유된 스냅샷으로 새로운 Amazon EBS를 생성할 수 있다. 기존 스냅샷에 어떠한 영향도 주지 않는다.
  4. 다른 리전(Region)으로 복사가 가능하다. 이러한 리전 간 복사 기능을 활용하여 전세계 원하는 리전으로의 지리적 확장이나, 데이터 센터 마이그레이션 및 재해복구를 손쉽게 수행할 수 있다.

<br />

##### Amazon EBS 성능과 보안성 높이기

- Amazon EBS는 EC2의 disk 성능 향상과 보안성을 높이기 위한 다양한 옵셕놔 기능을 보유 및 제공한다.
    1. 프로비저닝된 IOPS 이다. Amazon EBS 생성 시 EBS 유형에서 선택 가능한 옵션으로 Amazon EBS 의 성능을 높이기 위해 disk의 IOPS 성능을 지정할 수 있는 기능이다. EBS-Optimized 인스턴스에서 사용 가능하며, 보다 높은 I/O 성능을 제공하여 고성능의 서비스 제공에 적합한 EBS 유형이다. 
    2. EBS 최적화된 인스턴스이다. Amazon EBS의 disk서비스를 위한 전용 네트워크의 대역폭을 사용하도록 구성하여 disk 성능을 최적화하는 기능으로 EC2의 인스턴스 타입 중 C, M, R 시리즈에서 추가 비용없이 사용 가능하다. 또한 프로비저닝된 IOPS를 함께 사용하여 I/O의 최대 성능을 끌어내는 것이 가능하다.
    3. EBS 암호화 기능이다. Amazon EBS를 암호화 알고리즘 중 하나인 AES-256으로 암호화하여 EBS 내부의 데이터를 보호할 수 있는 기능으로 암호화 키는 AWS의 KMS에서 직접 생성하거나 기본키를 사용할 수 있다. 이렇게 암호화된 EBS 스냅샷은 공유 및 타 AWS계정에 공유되어도 사용할 수 없다.

<br />

### 5. Amazon 보안 그룹(Security Group)

<br />

#### Amazon 보안 그룹

- 보안 그룹은 인스턴스에 대한 인바운드, 아웃바운드의 네트워크 트래픽을 제어하는 가상의 방화벽 역할을 수행한다.
- EC2 인스턴스당 최대 5개의 보안 그룹을 할당할 수 있다.
- 이렇게 구성된 보안그룹은 기존의 온프라미스에서 사용되고 있는 방화벽의 정책과 유사한 기능이다.
- 보안 그룹은 네트워크 트래픽에 대한 허용만 가능하며 차단은 설정할 수 없다.
- 

<br />

#### Amazon 보안 그룹의 주요 특징 

1. 보안 그룹은 생성 가능한 보안 그룹의 숫자와 규칙에 제한이 있다
2. 네트워크 트래픽을 위한 `허용` 정책은 있으나 `차단` 정책은 없다.
3. 인바운드 트래픽과 아웃바운드 트래픽을 별도로 제어할 수 있다.
4. 초기 보안 그룹 설정에는 인바운드 보안 규칙이 없다. 

---